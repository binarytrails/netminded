<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>tracking.js - color with camera</title>
        <link rel="stylesheet" href="assets/demo.css">

        <script src="libs/tracking-min.js"></script>
        <script src="libs/dat.gui.min.js"></script>
        <script src="color_camera_gui.js"></script>

        <style>
        video, canvas {
            margin-left: 100px;
            margin-top: 35px;
            position: absolute;
        }
        </style>
    </head>
    <body>
        <div class="demo-title">
            <p><a href="http://trackingjs.com" target="_parent">tracking.js</a> Ôºç choose the colors you want to detect through the controls on the right</p>
        </div>

        <div class="demo-frame">
            <div class="demo-container">
                <video id="video" width="600" height="450" preload autoplay loop muted controls></video>
                <canvas id="canvas" width="600" height="450"></canvas>
            </div>
        </div>

        <script src="camera.js"></script>
        <script>
            var trackedColors;
            window.onload = function()
            {
                var video = document.getElementById('video'),
                    canvas = document.getElementById('canvas'),
                    context = canvas.getContext('2d'),
                    tracker = new tracking.ColorTracker();

                var colors = {
                    skin: '#877f7f',
                    snapback: '#0f307d',
                    yellowBallon: '#89893f'
                };

                var supportedColors = ["cyan", "magenta", "yellow"];
                    trackedColors = Object.keys(colors); //.concat(supportedColors);

                tracking.track('#video', tracker, { camera: true });

                tracker.on('track', function(event) {
                    context.clearRect(0, 0, canvas.width, canvas.height);

                    event.data.forEach(function(rect) {

                        console.log(rect.color);
                        rect.color = 'cyan';

                        context.strokeStyle = rect.color;
                        context.strokeRect(rect.x, rect.y, rect.width, rect.height);
                        context.font = '11px Helvetica';
                        context.fillStyle = "#fff";
                        context.fillText('x: ' + rect.x + 'px', rect.x + rect.width + 5, rect.y + 11);
                        context.fillText('y: ' + rect.y + 'px', rect.x + rect.width + 5, rect.y + 22);
                    });

                    for (var name in colors)
                    {
                        tracker.customColor = colors[name];
                        createCustomColor(tracking, name, colors[name]);
                    }
                    tracker.setColors(trackedColors);
                });

            };
        </script>
    </body>
</html>
